# ğŸ“± APK æ¶æ„è¯´æ˜æ–‡æ¡£

## ğŸ—ï¸ æ”¯æŒçš„ CPU æ¶æ„

Lumi Assistant æ”¯æŒä»¥ä¸‹ ARM æ¶æ„ï¼š

| æ¶æ„ | ä½æ•° | é€‚ç”¨è®¾å¤‡ | å¸‚åœºå æ¯” |
|------|------|---------|---------|
| **arm64-v8a** | 64ä½ | 2019å¹´åçš„ç°ä»£æ‰‹æœº | ~90% |
| **armeabi-v7a** | 32ä½ | 2019å¹´å‰çš„è€æ—§è®¾å¤‡ | ~10% |

### âŒ ä¸æ”¯æŒçš„æ¶æ„

- âŒ **x86** (32ä½ x86 æ¨¡æ‹Ÿå™¨)
- âŒ **x86_64** (64ä½ x86 æ¨¡æ‹Ÿå™¨)

**åŸå› **: è®¯é£ AIKit è¯­éŸ³åº“ä»…æä¾› ARM ç‰ˆæœ¬ï¼Œä¸æ”¯æŒ x86 æ¶æ„ã€‚

---

## ğŸ“¦ APK åˆ†å‰²ç­–ç•¥

é¡¹ç›®é…ç½®äº† APK åˆ†å‰²ï¼ˆAPK Splitsï¼‰ï¼Œæ¯æ¬¡æ„å»ºä¼šç”Ÿæˆ **3 ä¸ª APK æ–‡ä»¶**ï¼š

### 1. Universal APK (é€šç”¨ç‰ˆ)
- **æ–‡ä»¶å**: `app-universal-release.apk`
- **åŒ…å«æ¶æ„**: arm64-v8a + armeabi-v7a
- **ä½“ç§¯**: ~è¾ƒå¤§ (åŒ…å«æ‰€æœ‰æ¶æ„)
- **å…¼å®¹æ€§**: âœ… æ”¯æŒæ‰€æœ‰ ARM è®¾å¤‡
- **æ¨è**: ğŸŒŸ **æ™®é€šç”¨æˆ·ä¸‹è½½æ­¤ç‰ˆæœ¬**

### 2. ARM64-v8a APK (64ä½ç‰ˆ)
- **æ–‡ä»¶å**: `app-arm64-v8a-release.apk`
- **åŒ…å«æ¶æ„**: ä»… arm64-v8a
- **ä½“ç§¯**: ~è¾ƒå°
- **å…¼å®¹æ€§**: âœ… 2019å¹´åçš„ç°ä»£æ‰‹æœº
- **æ¨è**: æƒ³è¦æ›´å°ä½“ç§¯çš„ç°ä»£è®¾å¤‡ç”¨æˆ·

### 3. ARMv7 APK (32ä½ç‰ˆ)
- **æ–‡ä»¶å**: `app-armeabi-v7a-release.apk`
- **åŒ…å«æ¶æ„**: ä»… armeabi-v7a
- **ä½“ç§¯**: ~è¾ƒå°
- **å…¼å®¹æ€§**: âœ… è€æ—§ Android è®¾å¤‡
- **æ¨è**: ä½¿ç”¨è€æ—§è®¾å¤‡çš„ç”¨æˆ·

---

## ğŸ” å¦‚ä½•æŸ¥çœ‹è®¾å¤‡æ¶æ„ï¼Ÿ

### æ–¹æ³• 1: ä½¿ç”¨ ADB å‘½ä»¤

```bash
adb shell getprop ro.product.cpu.abi
```

**è¾“å‡ºç¤ºä¾‹**:
- `arm64-v8a` â†’ ä¸‹è½½ arm64-v8a æˆ– universal ç‰ˆæœ¬
- `armeabi-v7a` â†’ ä¸‹è½½ armeabi-v7a æˆ– universal ç‰ˆæœ¬

### æ–¹æ³• 2: ä½¿ç”¨ CPU-Z åº”ç”¨

1. åœ¨ Google Play å®‰è£… [CPU-Z](https://play.google.com/store/apps/details?id=com.cpuid.cpu_z)
2. æ‰“å¼€åº”ç”¨æŸ¥çœ‹ "SOC" â†’ "Architecture"

### æ–¹æ³• 3: Android è®¾ç½®

éƒ¨åˆ†è®¾å¤‡å¯åœ¨ `è®¾ç½®` â†’ `å…³äºæ‰‹æœº` â†’ `å¤„ç†å™¨` æŸ¥çœ‹

---

## ğŸ’¾ APK ä½“ç§¯å¯¹æ¯”

å‡è®¾é¡¹ç›®ç¼–è¯‘åå¤§å°ï¼ˆä»…ä¾›å‚è€ƒï¼‰ï¼š

| æ–‡ä»¶ | æ¶æ„ | é¢„ä¼°ä½“ç§¯ | Native åº“å¤§å° |
|------|------|---------|--------------|
| Universal | arm64 + armv7 | ~15-18 MB | arm64: ~6.7MB<br>armv7: ~4.2MB |
| ARM64-v8a | arm64 | ~12-14 MB | ~6.7 MB |
| ARMv7 | armv7 | ~10-12 MB | ~4.2 MB |

**Native åº“æ˜ç»†**:
- `opus.aar`:
  - arm64-v8a: 469 KB
  - armeabi-v7a: 467 KB
- `AIKit.aar`:
  - arm64-v8a: 6.3 MB
  - armeabi-v7a: 4.0 MB

---

## âš™ï¸ æ„å»ºé…ç½®è¯´æ˜

### Gradle é…ç½® (app/build.gradle.kts)

```kotlin
android {
    defaultConfig {
        // æŒ‡å®šæ‰“åŒ…çš„æ¶æ„
        ndk {
            abiFilters += listOf("arm64-v8a", "armeabi-v7a")
        }
    }

    // APK åˆ†å‰²é…ç½®
    splits {
        abi {
            isEnable = true
            reset()
            include("arm64-v8a", "armeabi-v7a")
            isUniversalApk = true  // ç”Ÿæˆé€šç”¨ APK
        }
    }
}
```

### ä¸ºä»€ä¹ˆä½¿ç”¨ APK åˆ†å‰²ï¼Ÿ

#### âœ… ä¼˜åŠ¿
1. **å‡å°ä¸‹è½½ä½“ç§¯**: ç”¨æˆ·åªéœ€ä¸‹è½½å¯¹åº”æ¶æ„çš„ APK
2. **èŠ‚çœå­˜å‚¨ç©ºé—´**: è®¾å¤‡ä¸Šåªå®‰è£…éœ€è¦çš„æ¶æ„åº“
3. **åŠ å¿«å®‰è£…é€Ÿåº¦**: æ›´å°çš„ APK å®‰è£…æ›´å¿«

#### âŒ åŠ£åŠ¿
1. **ç”¨æˆ·éœ€è¦é€‰æ‹©**: æ™®é€šç”¨æˆ·å¯èƒ½ä¸çŸ¥é“é€‰å“ªä¸ª
2. **ç®¡ç†å¤æ‚åº¦**: éœ€è¦ä¸Šä¼ å¤šä¸ªæ–‡ä»¶

**è§£å†³æ–¹æ¡ˆ**:
- æä¾› Universal APK ä½œä¸ºé»˜è®¤é€‰é¡¹
- åœ¨ Release Notes ä¸­æ˜ç¡®è¯´æ˜é€‰æ‹©æ–¹å¼

---

## ğŸš€ Google Play å‘å¸ƒå»ºè®®

å¦‚æœè®¡åˆ’å‘å¸ƒåˆ° Google Playï¼Œå»ºè®®ä½¿ç”¨ **Android App Bundle (AAB)**ï¼š

```bash
./gradlew bundleRelease
```

**AAB ä¼˜åŠ¿**:
- Google Play è‡ªåŠ¨ä¸ºç”¨æˆ·ç”Ÿæˆæœ€ä¼˜ APK
- ç”¨æˆ·ä¸‹è½½ä½“ç§¯æœ€å°åŒ–
- æ— éœ€æ‰‹åŠ¨ç®¡ç†å¤šæ¶æ„ APK

**ä¿®æ”¹é…ç½®** (æœªæ¥å¯é€‰):
```kotlin
buildTypes {
    release {
        // AAB é€‚åˆ Google Playï¼ŒAPK é€‚åˆç›´æ¥åˆ†å‘
    }
}
```

---

## ğŸ§ª æœ¬åœ°æµ‹è¯•æ„å»º

### æ„å»ºæ‰€æœ‰æ¶æ„ APK

```bash
./gradlew assembleRelease
```

**è¾“å‡ºä½ç½®**:
```
app/build/outputs/apk/release/
â”œâ”€â”€ app-arm64-v8a-release.apk       (64ä½ç‰ˆ)
â”œâ”€â”€ app-armeabi-v7a-release.apk     (32ä½ç‰ˆ)
â””â”€â”€ app-universal-release.apk       (é€šç”¨ç‰ˆ)
```

### æ„å»ºç‰¹å®šæ¶æ„

```bash
# ä»…æ„å»º ARM64 ç‰ˆæœ¬
./gradlew assembleArm64_v8aRelease

# ä»…æ„å»º ARMv7 ç‰ˆæœ¬
./gradlew assembleArmeabi_v7aRelease
```

---

## ğŸ“Š å¸‚åœºç»Ÿè®¡ (2025)

æ ¹æ® Google Play ç»Ÿè®¡ï¼š

| æ¶æ„ | å¸‚åœºå æœ‰ç‡ | ä»£è¡¨è®¾å¤‡ |
|------|-----------|---------|
| ARM64-v8a | ~92% | å¤§éƒ¨åˆ†ç°ä»£æ‰‹æœº |
| ARMv7 | ~7% | è€æ—§è®¾å¤‡ |
| x86/x86_64 | ~1% | æ¨¡æ‹Ÿå™¨ã€ç‰¹æ®Šè®¾å¤‡ |

**ç»“è®º**: æ”¯æŒ ARM64 + ARMv7 å·²è¦†ç›– **99%** çš„çœŸå® Android è®¾å¤‡ã€‚

---

## â“ å¸¸è§é—®é¢˜

### Q1: ä¸ºä»€ä¹ˆä¸æ”¯æŒ x86 æ¨¡æ‹Ÿå™¨ï¼Ÿ

**A**: è®¯é£ AIKit è¯­éŸ³å”¤é†’åº“ä¸æä¾› x86 ç‰ˆæœ¬ã€‚å¦‚éœ€æ¨¡æ‹Ÿå™¨æµ‹è¯•ï¼š
- ä½¿ç”¨ ARM æ¨¡æ‹Ÿå™¨é•œåƒ
- æˆ–åœ¨çœŸæœºä¸Šæµ‹è¯•

### Q2: ç”¨æˆ·ä¸‹è½½é”™äº†æ¶æ„æ€ä¹ˆåŠï¼Ÿ

**A**:
- **æœ€ä½³æ–¹æ¡ˆ**: å¼•å¯¼ä¸‹è½½ Universal APKï¼ˆå…¼å®¹æ‰€æœ‰è®¾å¤‡ï¼‰
- **é”™è¯¯æç¤º**: å¦‚æœä¸‹è½½ arm64 APK å®‰è£…åˆ° armv7 è®¾å¤‡ï¼Œç³»ç»Ÿä¼šæç¤º "åº”ç”¨æ— æ³•å®‰è£…"

### Q3: å¦‚ä½•å‡å° Universal APK ä½“ç§¯ï¼Ÿ

**A**:
1. å¯ç”¨ä»£ç æ··æ·† (`isMinifyEnabled = true`)
2. å¯ç”¨èµ„æºå‹ç¼© (`isShrinkResources = true`)
3. ç§»é™¤æœªä½¿ç”¨çš„è¯­è¨€èµ„æº
4. ä½¿ç”¨ WebP æ›¿ä»£ PNG

### Q4: æœªæ¥å¦‚ä½•æ·»åŠ  x86 æ”¯æŒï¼Ÿ

**A**: éœ€è¦æ›´æ¢æˆ–è¡¥å……æ”¯æŒ x86 çš„è¯­éŸ³åº“ï¼š
```kotlin
ndk {
    abiFilters += listOf("arm64-v8a", "armeabi-v7a", "x86", "x86_64")
}
```

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [Android ABI ç®¡ç†](https://developer.android.com/ndk/guides/abis)
- [APK Splits é…ç½®](https://developer.android.com/studio/build/configure-apk-splits)
- [Android App Bundle](https://developer.android.com/guide/app-bundle)

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0
**æ›´æ–°æ—¥æœŸ**: 2025-01-25
**ç»´æŠ¤è€…**: Lumi Assistant Team
